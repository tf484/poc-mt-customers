<mvc:View controllerName="contexts.controller.ContextList"
    xmlns:mvc="sap.ui.core.mvc" displayBlock="true"
    xmlns="sap.m"
    xmlns:core="sap.ui.core"
    xmlns:f="sap.f"
    xmlns:fb="sap.ui.comp.filterbar">
    <Page id="page" title="{i18n>title}">
        <customHeader>
            <OverflowToolbar id="headerBar">
                <content>
                    <Image id="headerImage" height="25px" src="../webapp/images/aicomp.png"/>
                    <ToolbarSpacer id="toolbarSpacer1"/>
                </content>
            </OverflowToolbar>
        </customHeader>
        <content>
            <f:DynamicPage id="dynamicPage" class="sapUiResponsivePadding" showFooter="true">
                <f:title>
                    <f:DynamicPageTitle id="dynamicPageTitle">
                        <f:heading>
                            <Title id="title" text="{i18n>title}" />
                        </f:heading>
                    </f:DynamicPageTitle>
                </f:title>
                <f:content>
                    <VBox id="vbox02">
                        <fb:FilterBar id="filterbar" reset="onReset" clear="onClearFilter" search="onSearch" useToolbar="false" showFilterConfiguration="false" showClearOnFB="true">
                            <fb:filterGroupItems>
                                <fb:FilterGroupItem id="fgi1" groupName="G1" name="A" label="{i18n>search}" visibleInFilterBar="true">
                                    <fb:control>
                                        <SearchField id="searchFilterInput" value="{viewData>/searchFilter}" search="onSearch"/>
                                    </fb:control>
                                </fb:FilterGroupItem>
                                <fb:FilterGroupItem id="fgi2" groupName="G1" name="B" label="{i18n>contextCategory}" visibleInFilterBar="true">
                                    <fb:control>
                                        <MultiComboBox id="contextCategoryFilterComboBox" selectedKeys="{viewData>/contextCategoryFilters}" items="{ path: '/ContextCategories', sorter: { path: 'name' } }">
                                            <core:Item id="contextCategoryItem" key="{code}" text="{name}" />
                                        </MultiComboBox>

                                    </fb:control>
                                </fb:FilterGroupItem>
                                <fb:FilterGroupItem id="fgi3" groupName="G1" name="C" label="{i18n>contextType}" visibleInFilterBar="true">
                                    <fb:control>
                                        <MultiComboBox id="contextTypesFilterComboBox" selectedKeys="{viewData>/contextTypeFilters}" items="{ path: '/ContextTypes', sorter: { path: 'name' } }">
                                            <core:Item id="contextTypeItem" key="{code}" text="{name}" />
                                        </MultiComboBox>
                                    </fb:control>
                                </fb:FilterGroupItem>
                                <fb:FilterGroupItem id="fgi4" groupName="G1" name="D" label="{i18n>status}" visibleInFilterBar="true">
                                    <fb:control>
                                        <SegmentedButton id="statusFilter" selectedKey="{viewData>/statusFilter}">
                                            <items>
                                                <SegmentedButtonItem id="statusAll" text="{i18n>all}" key="all" />
                                                <SegmentedButtonItem id="statusActive" text="{i18n>active}" key="active" />
                                                <SegmentedButtonItem id="statusInactive" text="{i18n>inactive}" key="inactive" />
                                            </items>
                                        </SegmentedButton>
                                    </fb:control>
                                </fb:FilterGroupItem>
                            </fb:filterGroupItems>
                        </fb:FilterBar>
                        <Table id="contextsTable" growing="true" autoPopinMode="true" items="{
                            path: '/Contexts',
                            parameters: { expand: 'contextTypes,contextCategories' },
                            filters: [{
                                path: 'inactive',
                                operator: 'EQ',
                                value1: false
                            }],
                            sorter: {
                                path: 'compositeKey'
                            }

                        }">
                            <headerToolbar>
                                <OverflowToolbar id="contextsTableOverFlowToolbar">
                                    <Title id="contextsTableTitle" text="{i18n>contexts}" level="H2"/>
                                    <ToolbarSpacer id="toolbarSpacer01"/>
                                    <Button id="contextCreateButton" icon="sap-icon://add" tooltip="{i18n>createContext}" press="onCreateContextDialog"/>
                                    <Button id="refreshButton" icon="sap-icon://refresh" tooltip="{i18n>refresh}" press="onRefresh"/>
                                </OverflowToolbar>
                            </headerToolbar>
                            <columns>
                                <Column id="compositeKeyContextIDColumn" importance="High">
                                    <Text id="compositeKeyContextIDText" text="{i18n>compositeKeyContextID}" />
                                </Column>
                                <Column id="externalNameColumn" importance="Low">
                                    <Text id="externalNameText" text="{i18n>externalName}"/>
                                </Column>
                                <Column id="descriptionColumn" importance="Low">
                                    <Text id="descriptionText" text="{i18n>description}" />
                                </Column>
                                <Column id="contextCategoryColumn" importance="Low">
                                    <Text id="contextCategoryText" text="{i18n>contextCategory}" />
                                </Column>
                                <Column id="contextTypeColumn" importance="Low">
                                    <Text id="contextTypeText" text="{i18n>contextType}" />
                                </Column>
                                <Column id="statusColumn" importance="Low">
                                    <Text id="statusText" text="{i18n>status}" />
                                </Column>
                                <Column id="actionsColumn" importance="Low">
                                </Column>
                            </columns>
                            <items>
                                <ColumnListItem id="columnListItem" vAlign="Middle">
                                    <cells>
                                        <ObjectIdentifier id="objectIdentifier" title="{compositeKey}" text="{ID}" />
                                        <Text id="externalNameCellText" text="{externalName}" wrapping="false"/>
                                        <Text id="descriptionCellText" text="{description}" />
                                        <Text id="contextCategoryCellText"  text="{contextCategory/name}" />
                                        <Text id="contextTypeCellText" text="{contextType/name}" />
                                        <ObjectStatus id="objectStatus" 
			                                text="{= ${inactive} === 'Yes' ? 'Inactive' : 'Active' }"
			                                inverted="true"
			                                icon="{= ${inactive} === 'Yes' ? 'sap-icon://error' : 'sap-icon://sys-enter-2' }"
			                                state="{= ${inactive} === 'Yes' ? 'Error' : 'Success' }"/> 
                                        <MenuButton id="actionMenuButton"  text="{i18n>actions}">
                                            <menu>
                                                <Menu id="actionMenu" >
                                                    <MenuItem id="editAction" text="{i18n>edit}" icon="sap-icon://edit" press="onEditContextDialog">
                                                        <customData>
                                                            <core:CustomData key="contextID" value="{ID}" />
                                                        </customData>
                                                    </MenuItem>
                                                    <MenuItem id="statusAction" text="{= ${inactive} === 'Yes' ? ${i18n>activate} : ${i18n>inactivate} }" icon="{= ${inactive} === 'Yes' ? 'sap-icon://sys-enter-2' : 'sap-icon://error' }" press="onToggleStatus" >
                                                        <customData>
                                                            <core:CustomData key="contextID" value="{ID}" />
                                                            <core:CustomData key="compositeKey" value="{compositeKey}" />
                                                        </customData>
                                                    </MenuItem>
                                                </Menu>
                                            </menu>
                                        </MenuButton>
                                    </cells>
                                </ColumnListItem>
                            </items>
                        </Table>
                    </VBox>
                </f:content>
            </f:DynamicPage>
        </content>
    </Page>
</mvc:View>
